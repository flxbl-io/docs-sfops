# 4. Trigger the workflows

After setting up your environments and variables, you can deploy sfops using these workflows:

## Production Deployment

### Release and Deploy to Production

**Workflow:** release-please  
**How to trigger:**
1. Go to Actions → "release-please" from the left sidebar
2. Click "Run workflow" for manual trigger
3. Or it runs automatically on pushes to main branch

This workflow:
- Creates releases using release-please (when changes are detected)
- For each environment in `ORGS`:
  - Builds sfops and sfops-lite Docker images from base sfp-pro images
  - Uses `BASE_REGISTRY`, `BASE_REPO`, `BASE_IMAGE_NAME` variables to pull the base image
  - Tags images with version number (e.g., `31.2.0`) and `latest`
  - Pushes built images to ghcr.io
  - Syncs sfops-gh-actions and sfops-dashboard to the environment

## Test/Development Deployment

### Deploy to Test & Alpha Environments

**Workflow:** Sync to Test & Alpha Organizations  
**How to trigger:**
1. Go to Actions → "Sync to Test & Alpha Organizations" from the left sidebar
2. Click "Run workflow"
3. Option to skip Docker build if images already exist
4. Or it runs automatically on pushes to main (when specific paths change)

This workflow:
- For each environment in `TEST_ORGS` and `ALPHA_ORGS`:
  - Builds sfops and sfops-lite Docker images from RC base images
  - Uses `BASE_IMAGE_NAME_RC` (defaults to `sfp-pro-rc`) for base images
  - Tags images with version and `development` tag
  - Pushes built images to ghcr.io
  - Syncs sfops-gh-actions and sfops-dashboard to the environment

## Single Environment Deployment

### Deploy to a Specific Environment

**Workflow:** Sync Single Organization  
**How to trigger:**
1. Go to Actions → "Sync Single Organization" from the left sidebar
2. Click "Run workflow"
3. Enter the environment name (must match one in TEST_ORGS or ORGS)
4. Option to skip Docker build if images already exist

This workflow:
- Builds Docker images for the specified environment (unless skipped)
- Syncs sfops-gh-actions and sfops-dashboard to that single environment
- Useful for targeted deployments or retries

## Troubleshooting Docker Builds

If your Docker build fails with errors like:
- `403 Forbidden` or `not found` for base images: 
  - Ensure `BASE_REGISTRY_USERNAME` and `BASE_REGISTRY_TOKEN` secrets are set correctly
  - Verify the base image exists at the specified registry
  - Check that your PAT has `read:packages` permission for the base registry

- Authentication errors when pushing:
  - Ensure `DOCKER_USERNAME` and `DOCKER_SECRET` secrets are set
  - Verify your PAT has `write:packages` permission

{% hint style="info" %}
**Base Image Configuration:**
- Production uses: `sfp-pro:latest` (or your custom base via BASE_IMAGE_NAME)
- Test/Alpha uses: `sfp-pro-rc:development` (or your custom RC base via BASE_IMAGE_NAME_RC)
{% endhint %}

{% hint style="warning" %}
These variables will be automatically set up during the set up of sfops in your repository by the FLXBL team. This guide is only applicable when you are setting up a self managed instance of sfops
{% endhint %}